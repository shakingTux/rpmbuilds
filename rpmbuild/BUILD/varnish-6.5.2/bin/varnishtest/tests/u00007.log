**** dT   0.000
*    top  TEST ./tests/u00007.vtc starting
**** top  extmacro def pwd=/root/rpmbuild/BUILD/varnish-6.5.2/bin/varnishtest
**** top  extmacro def localhost=127.0.0.1
**** top  extmacro def bad_backend=127.0.0.1 45799
**** top  extmacro def bad_ip=192.0.2.255
**** top  extmacro def topbuild=/root/rpmbuild/BUILD/varnish-6.5.2
**** top  macro def testdir=/root/rpmbuild/BUILD/varnish-6.5.2/bin/varnishtest/./tests
**** top  macro def tmpdir=/tmp/vtc.104239.0f067f3f
**   top  === varnishtest "varnishhist coverage"
*    top  VTEST varnishhist coverage
**   top  === server s1 {
**   s1   Starting server
**** s1   macro def s1_addr=127.0.0.1
**** s1   macro def s1_port=35609
**** s1   macro def s1_sock=127.0.0.1 35609
*    s1   Listen on 127.0.0.1 35609
**   top  === varnish v1 -vcl+backend {} -start
**** dT   0.002
**   s1   Started on 127.0.0.1 35609 (1 iterations)
**** dT   0.004
**   v1   Launch
***  v1   CMD: cd ${pwd} && exec varnishd  -d -n /tmp/vtc.104239.0f067f3f/v1 -l 2m -p auto_restart=off -p syslog_cli_traffic=off -p sigsegv_handler=on -p thread_pool_min=10 -p debug=+vtc_mode -p vsl_mask=+Debug -a '127.0.0.1:0' -M '127.0.0.1 46365' -P /tmp/vtc.104239.0f067f3f/v1/varnishd.pid -p vmod_path=/root/rpmbuild/BUILD/varnish-6.5.2/lib/libvmod_blob/.libs:/root/rpmbuild/BUILD/varnish-6.5.2/lib/libvmod_cookie/.libs:/root/rpmbuild/BUILD/varnish-6.5.2/lib/libvmod_std/.libs:/root/rpmbuild/BUILD/varnish-6.5.2/lib/libvmod_vtc/.libs:/root/rpmbuild/BUILD/varnish-6.5.2/lib/libvmod_unix/.libs:/root/rpmbuild/BUILD/varnish-6.5.2/lib/libvmod_proxy/.libs:/root/rpmbuild/BUILD/varnish-6.5.2/lib/libvmod_purge/.libs:/root/rpmbuild/BUILD/varnish-6.5.2/lib/libvmod_directors/.libs:/root/rpmbuild/BUILD/varnish-6.5.2/lib/libvmod_debug/.libs 
***  v1   CMD: cd /root/rpmbuild/BUILD/varnish-6.5.2/bin/varnishtest && exec varnishd  -d -n /tmp/vtc.104239.0f067f3f/v1 -l 2m -p auto_restart=off -p syslog_cli_traffic=off -p sigsegv_handler=on -p thread_pool_min=10 -p debug=+vtc_mode -p vsl_mask=+Debug -a '127.0.0.1:0' -M '127.0.0.1 46365' -P /tmp/vtc.104239.0f067f3f/v1/varnishd.pid -p vmod_path=/root/rpmbuild/BUILD/varnish-6.5.2/lib/libvmod_blob/.libs:/root/rpmbuild/BUILD/varnish-6.5.2/lib/libvmod_cookie/.libs:/root/rpmbuild/BUILD/varnish-6.5.2/lib/libvmod_std/.libs:/root/rpmbuild/BUILD/varnish-6.5.2/lib/libvmod_vtc/.libs:/root/rpmbuild/BUILD/varnish-6.5.2/lib/libvmod_unix/.libs:/root/rpmbuild/BUILD/varnish-6.5.2/lib/libvmod_proxy/.libs:/root/rpmbuild/BUILD/varnish-6.5.2/lib/libvmod_purge/.libs:/root/rpmbuild/BUILD/varnish-6.5.2/lib/libvmod_directors/.libs:/root/rpmbuild/BUILD/varnish-6.5.2/lib/libvmod_debug/.libs 
***  v1   PID: 104279
**** v1   macro def v1_pid=104279
**** v1   macro def v1_name=/tmp/vtc.104239.0f067f3f/v1
**** dT   0.012
***  v1   debug|Debug: Version: varnish-6.5.2 revision e7233b0ad2639043341819d19a8d2e418e94ce1b
***  v1   debug|Debug: Platform: Linux,5.3.18-59.24-default,x86_64,-jnone,-sdefault,-sdefault,-hcritbit
***  v1   debug|200 321     
***  v1   debug|-----------------------------
***  v1   debug|Varnish Cache CLI 1.0
***  v1   debug|-----------------------------
***  v1   debug|Linux,5.3.18-59.24-default,x86_64,-jnone,-sdefault,-sdefault,-hcritbit
***  v1   debug|varnish-6.5.2 revision e7233b0ad2639043341819d19a8d2e418e94ce1b
***  v1   debug|
***  v1   debug|Type 'help' for command list.
***  v1   debug|Type 'quit' to close CLI session.
***  v1   debug|Type 'start' to launch worker process.
***  v1   debug|
**** dT   0.110
**** v1   CLIPOLL 1 0x1 0x0
***  v1   CLI connection fd = 7
***  v1   CLI RX  107
**** v1   CLI RX|mnspkvzakzblspipnatrqvybhfnfhcql
**** v1   CLI RX|
**** v1   CLI RX|Authentication required.
**** v1   CLI TX|auth c90ddfbc5cca7e9d1a033d65716c031af6d9c6f1d422f9a096c6e10b14c68988
**** dT   0.111
***  v1   CLI RX  200
**** v1   CLI RX|-----------------------------
**** v1   CLI RX|Varnish Cache CLI 1.0
**** v1   CLI RX|-----------------------------
**** v1   CLI RX|Linux,5.3.18-59.24-default,x86_64,-jnone,-sdefault,-sdefault,-hcritbit
**** v1   CLI RX|varnish-6.5.2 revision e7233b0ad2639043341819d19a8d2e418e94ce1b
**** v1   CLI RX|
**** v1   CLI RX|Type 'help' for command list.
**** v1   CLI RX|Type 'quit' to close CLI session.
**** v1   CLI RX|Type 'start' to launch worker process.
**** v1   CLI TX|vcl.inline vcl1 << %XJEIFLH|)Xspa8P
**** v1   CLI TX|vcl 4.1;
**** v1   CLI TX|backend s1 { .host = "127.0.0.1"; .port = "35609"; }
**** v1   CLI TX|
**** v1   CLI TX|
**** v1   CLI TX|%XJEIFLH|)Xspa8P
**** dT   0.212
***  v1   vsl|No VSL chunk found (child not started ?)
**** dT   0.262
***  v1   CLI RX  200
**** v1   CLI RX|VCL compiled.
**** v1   CLI TX|vcl.use vcl1
***  v1   CLI RX  200
**   v1   Start
**** v1   CLI TX|start
**** dT   0.265
***  v1   debug|Debug: Child (104540) Started
**** dT   0.291
***  v1   CLI RX  200
***  v1   wait-running
**** v1   CLI TX|status
***  v1   debug|Info: Child (104540) said Child starts
***  v1   CLI RX  200
**** v1   CLI RX|Child in state running
**** v1   CLI TX|debug.listen_address
***  v1   CLI RX  200
**** v1   CLI RX|127.0.0.1 34813
**** v1   CLI TX|debug.xid 999
***  v1   CLI RX  200
**** v1   CLI RX|XID is 999
**** v1   CLI TX|debug.listen_address
***  v1   CLI RX  200
**** v1   CLI RX|127.0.0.1 34813
**   v1   Listen on 127.0.0.1 34813
**** v1   macro def v1_addr=127.0.0.1
**** v1   macro def v1_port=34813
**** v1   macro def v1_sock=127.0.0.1 34813
**** dT   0.313
**** v1   vsl|          0 CLI             - Rd vcl.load "vcl1" vcl_vcl1.1634893314.690654/vgc.so 1auto
**** v1   vsl|          0 CLI             - Wr 200 52 Loaded "vcl_vcl1.1634893314.690654/vgc.so" as "vcl1"
**** v1   vsl|          0 CLI             - Rd vcl.use "vcl1"
**** v1   vsl|          0 CLI             - Wr 200 0 
**** v1   vsl|          0 CLI             - Rd start
**** v1   vsl|          0 CLI             - Wr 200 0 
**** v1   vsl|          0 CLI             - Rd debug.listen_address 
**** v1   vsl|          0 CLI             - Wr 200 16 127.0.0.1 34813

**** v1   vsl|          0 CLI             - Rd debug.xid 999 
**** v1   vsl|          0 CLI             - Wr 200 10 XID is 999
**** v1   vsl|          0 CLI             - Rd debug.listen_address 
**** v1   vsl|          0 CLI             - Wr 200 16 127.0.0.1 34813

**** dT   0.391
**   top  === shell -match "Usage: .*varnishhist <options>" \
**** top  shell_cmd|exec 2>&1 ; varnishhist -h
**** dT   0.406
**** top  shell_out|Usage: /root/rpmbuild/BUILD/varnish-6.5.2/bin/varnishhist/.libs/varnishhist <options>
**** top  shell_out|
**** top  shell_out|Options:
**** top  shell_out| [-B <factor>]             Time bending
**** top  shell_out| [-C]                      Caseless regular expressions
**** top  shell_out| [-d]                      Process old log entries and exit
**** top  shell_out| [-g <request|vxid>]       Grouping mode (default: vxid)
**** top  shell_out| [-h]                      Usage help
**** top  shell_out| [-L <limit>]              Incomplete transaction limit
**** top  shell_out| [-n <dir>]                varnishd working directory
**** top  shell_out| [-p <period>]             Refresh period
**** top  shell_out| [-P responsetime]         Predefined client profile
**** top  shell_out| [-P reqbodytime]          Predefined client profile
**** top  shell_out| [-P size]                 Predefined client profile
**** top  shell_out| [-P Bereqtime]            Predefined backend profile
**** top  shell_out| [-P Beresptime]           Predefined backend profile
**** top  shell_out| [-P BerespBodytime]       Predefined backend profile
**** top  shell_out| [-P Besize]               Predefined backend profile
**** top  shell_out| [-P <[cb:]tag:[prefix]:field_num[:min:max]>] Custom profile definition
**** top  shell_out| [-Q <file>]               VSL query file
**** top  shell_out| [-q <query>]              VSL query
**** top  shell_out| [-r <filename>]           Binary file input
**** top  shell_out| [-t <seconds|off>]        VSM connection timeout
**** top  shell_out| [-T <seconds>]            Transaction end timeout
**** top  shell_out| [-V]                      Version
**** top  shell_status = 0x0000
**** top  shell_match succeeded
**   top  === shell -expect "Copyright (c) 2006 Verdens Gang AS" \
**** top  shell_cmd|exec 2>&1 ; varnishhist -V
**** dT   0.421
**** top  shell_out|/root/rpmbuild/BUILD/varnish-6.5.2/bin/varnishhist/.libs/varnishhist (varnish-6.5.2 revision e7233b0ad2639043341819d19a8d2e418e94ce1b)
**** top  shell_out|Copyright (c) 2006 Verdens Gang AS
**** top  shell_out|Copyright (c) 2006-2020 Varnish Software
**** top  shell_status = 0x0000
**** top  shell_expect found
**   top  === shell -err -match "Usage: .*varnishhist <options>" \
**** dT   0.422
**** top  shell_cmd|exec 2>&1 ; varnishhist -K
**** dT   0.435
**** top  shell_out|/root/rpmbuild/BUILD/varnish-6.5.2/bin/varnishhist/.libs/varnishhist: invalid option -- 'K'
**** top  shell_out|Usage: /root/rpmbuild/BUILD/varnish-6.5.2/bin/varnishhist/.libs/varnishhist <options>
**** top  shell_out|
**** top  shell_out|Options:
**** top  shell_out| [-B <factor>]             Time bending
**** top  shell_out| [-C]                      Caseless regular expressions
**** top  shell_out| [-d]                      Process old log entries and exit
**** top  shell_out| [-g <request|vxid>]       Grouping mode (default: vxid)
**** top  shell_out| [-h]                      Usage help
**** top  shell_out| [-L <limit>]              Incomplete transaction limit
**** top  shell_out| [-n <dir>]                varnishd working directory
**** top  shell_out| [-p <period>]             Refresh period
**** top  shell_out| [-P responsetime]         Predefined client profile
**** top  shell_out| [-P reqbodytime]          Predefined client profile
**** top  shell_out| [-P size]                 Predefined client profile
**** top  shell_out| [-P Bereqtime]            Predefined backend profile
**** top  shell_out| [-P Beresptime]           Predefined backend profile
**** top  shell_out| [-P BerespBodytime]       Predefined backend profile
**** top  shell_out| [-P Besize]               Predefined backend profile
**** top  shell_out| [-P <[cb:]tag:[prefix]:field_num[:min:max]>] Custom profile definition
**** top  shell_out| [-Q <file>]               VSL query file
**** top  shell_out| [-q <query>]              VSL query
**** top  shell_out| [-r <filename>]           Binary file input
**** top  shell_out| [-t <seconds|off>]        VSM connection timeout
**** top  shell_out| [-T <seconds>]            Transaction end timeout
**** top  shell_out| [-V]                      Version
**** top  shell_status = 0x0001
**** top  shell_match succeeded
**   top  === shell -err -match "Usage: .*varnishhist <options>" \
**** top  shell_cmd|exec 2>&1 ; varnishhist extra
**** dT   0.449
**** top  shell_out|Usage: /root/rpmbuild/BUILD/varnish-6.5.2/bin/varnishhist/.libs/varnishhist <options>
**** top  shell_out|
**** top  shell_out|Options:
**** top  shell_out| [-B <factor>]             Time bending
**** top  shell_out| [-C]                      Caseless regular expressions
**** top  shell_out| [-d]                      Process old log entries and exit
**** top  shell_out| [-g <request|vxid>]       Grouping mode (default: vxid)
**** top  shell_out| [-h]                      Usage help
**** top  shell_out| [-L <limit>]              Incomplete transaction limit
**** top  shell_out| [-n <dir>]                varnishd working directory
**** top  shell_out| [-p <period>]             Refresh period
**** top  shell_out| [-P responsetime]         Predefined client profile
**** top  shell_out| [-P reqbodytime]          Predefined client profile
**** top  shell_out| [-P size]                 Predefined client profile
**** top  shell_out| [-P Bereqtime]            Predefined backend profile
**** top  shell_out| [-P Beresptime]           Predefined backend profile
**** top  shell_out| [-P BerespBodytime]       Predefined backend profile
**** top  shell_out| [-P Besize]               Predefined backend profile
**** top  shell_out| [-P <[cb:]tag:[prefix]:field_num[:min:max]>] Custom profile definition
**** top  shell_out| [-Q <file>]               VSL query file
**** top  shell_out| [-q <query>]              VSL query
**** top  shell_out| [-r <filename>]           Binary file input
**** top  shell_out| [-t <seconds|off>]        VSM connection timeout
**** top  shell_out| [-T <seconds>]            Transaction end timeout
**** top  shell_out| [-V]                      Version
**** top  shell_status = 0x0001
**** top  shell_match succeeded
**   top  === shell -err -expect "-p: invalid '0'" \
**** top  shell_cmd|exec 2>&1 ; varnishhist -p 0
**** dT   0.463
**** top  shell_out|-p: invalid '0'
**** top  shell_status = 0x0001
**** top  shell_expect found
**   top  === shell -err -expect "-B: being able to bend time does not mea...
**** top  shell_cmd|exec 2>&1 ; varnishhist -p 2.0 -B 0
**** dT   0.477
**** top  shell_out|-B: being able to bend time does not mean we can stop it (invalid factor '0')
**** top  shell_status = 0x0001
**** top  shell_expect found
**   top  === shell -err -expect "-B: being able to bend time does not mea...
**** top  shell_cmd|exec 2>&1 ; varnishhist -B -1
**** dT   0.490
**** top  shell_out|-B: being able to bend time does not mean we can make it go backwards (invalid factor '-1')
**** top  shell_status = 0x0001
**** top  shell_expect found
**   top  === shell -err -expect "Invalid grouping mode: raw" \
**** top  shell_cmd|exec 2>&1 ; varnishhist -g raw
**** dT   0.505
**** top  shell_out|Invalid grouping mode: raw (only vxid and request are supported)
**** top  shell_status = 0x0001
**** top  shell_expect found
**   top  === shell -err -expect "-P: No such profile 'foo'" \
**** top  shell_cmd|exec 2>&1 ; varnishhist -P foo
**** dT   0.518
**** top  shell_out|-P: No such profile 'foo'
**** top  shell_status = 0x0001
**** top  shell_expect found
**   top  === shell -err -expect "-P: 'Timestamp:' is not a valid profile ...
**** top  shell_cmd|exec 2>&1 ; varnishhist -P Timestamp::
**** dT   0.532
**** top  shell_out|-P: 'Timestamp:' is not a valid profile name or definition
**** top  shell_status = 0x0001
**** top  shell_expect found
**   top  === shell -err -expect "-P: 'b:' is not a valid profile name or ...
**** top  shell_cmd|exec 2>&1 ; varnishhist -P b:
**** dT   0.545
**** top  shell_out|-P: 'b:' is not a valid profile name or definition
**** top  shell_status = 0x0001
**** top  shell_expect found
**   top  === shell -err -expect "-P: 'foo:' is not a valid tag name" \
**** top  shell_cmd|exec 2>&1 ; varnishhist -P foo:
**** dT   0.557
**** top  shell_out|-P: 'foo:' is not a valid tag name
**** top  shell_status = 0x0001
**** top  shell_expect found
**   top  === shell -err -expect "-P: 'b:Debug:' is an unsafe or binary re...
**** top  shell_cmd|exec 2>&1 ; varnishhist -P b:Debug:
**** dT   0.570
**** top  shell_out|-P: 'b:Debug:' is an unsafe or binary record
**** top  shell_status = 0x0001
**** top  shell_expect found
**   top  === shell -err -expect "-P: 'b:BereqAcct:x' is not a valid profi...
**** top  shell_cmd|exec 2>&1 ; varnishhist -P b:BereqAcct:x
**** dT   0.583
**** top  shell_out|-P: 'b:BereqAcct:x' is not a valid profile name or definition
**** top  shell_status = 0x0001
**** top  shell_expect found
**   top  === shell -err -expect "-P: 'b:BereqAcct:x' is not a valid profi...
**** top  shell_cmd|exec 2>&1 ; varnishhist -P b:BereqAcct:x:
**** dT   0.597
**** top  shell_out|-P: 'b:BereqAcct:x' is not a valid profile name or definition
**** top  shell_status = 0x0001
**** top  shell_expect found
**   top  === shell -err -expect "-P: 'b:BereqAcct:' is not a valid profil...
**** top  shell_cmd|exec 2>&1 ; varnishhist -P b:BereqAcct::5:1:a
**** dT   0.612
**** top  shell_out|-P: 'b:BereqAcct:' is not a valid profile name or definition
**** top  shell_status = 0x0001
**** top  shell_expect found
**   top  === shell -err -expect "-p: invalid '0'" \
**** top  shell_cmd|exec 2>&1 ; varnishhist -P b:BereqAcct::5 -p 0
**** dT   0.625
**** top  shell_out|-p: invalid '0'
**** top  shell_status = 0x0001
**** top  shell_expect found
*    top  RESETTING after ./tests/u00007.vtc
**   s1   Waiting for server (4/-1)
**** dT   0.626
**   v1   Wait
**** v1   CLI TX|backend.list
***  v1   CLI RX  200
**** v1   CLI RX|Backend name   Admin      Probe    Health     Last change
**** v1   CLI RX|vcl1.s1        healthy    0/0      healthy    Fri, 22 Oct 2021 09:01:54 GMT
**   v1   Stop
**** v1   CLI TX|stop
***  v1   debug|Debug: Stopping Child
**** dT   0.713
**** v1   vsl|          0 CLI             - Rd backend.list 
**** v1   vsl|          0 CLI             - Wr 200 134 Backend name   Admin      Probe    Health     Last change
vcl1.s1        healthy    0/0      healthy    Fri, 22 Oct 2021 09:01:54 GMT

**** v1   vsl|          0 CLI             - EOF on CLI connection, worker stops
**** dT   1.627
***  v1   debug|Info: Child (104540) ended
***  v1   debug|Info: Child (104540) said Child dies
***  v1   debug|Debug: Child cleanup complete
***  v1   CLI RX  200
***  v1   wait-stopped
**** v1   CLI TX|status
***  v1   CLI RX  200
**** v1   CLI RX|Child in state stopped
**** v1   CLI TX|panic.clear
***  v1   CLI RX  300
**** v1   CLI RX|No panic to clear
***  v1   debug|Info: manager stopping child
***  v1   debug|Info: manager dies
**** v1   STDOUT EOF
**** dT   1.714
**   v1   WAIT4 pid=104279 status=0x0000 (user 0.126219 sys 0.042348)
*    top  TEST ./tests/u00007.vtc completed
#    top  TEST ./tests/u00007.vtc passed (1.715)
